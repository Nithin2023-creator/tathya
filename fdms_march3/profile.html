<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FacultyFlow - Teacher Information</title>
    <style>
        /* Existing CSS styles */
        .info-card {
            background-color: white;
            border-radius: 5px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .info-row {
            display: flex;
            margin-bottom: 15px;
        }
        
        .info-col {
            flex: 1;
        }
        
        .info-label {
            font-weight: bold;
            margin-right: 5px;
        }
        
        .action-buttons {
            margin-bottom: 20px;
        }
        
        .btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 8px 15px;
            margin-right: 10px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .btn:hover {
            background-color: #45a049;
        }
        
        .btn-secondary {
            background-color: #555;
        }
        
        .btn-secondary:hover {
            background-color: #666;
        }
        
        .timetable {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .timetable th, .timetable td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }
        
        .timetable th {
            background-color: #f2f2f2;
        }
        
        .timetable td {
            background-color: white;
        }
        
        .day-column {
            background-color: #00cc7a !important;
            color: white;
            font-weight: bold;
        }
        
        .free-slot {
            background-color: white;
        }
        
        .break-slot {
            background-color: #f2f2f2;
        }
        
        .class-slot {
            color: #333;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        
        .modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 60%;
            border-radius: 5px;
            max-width: 600px;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: black;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        
        .timetable-cell {
            cursor: pointer;
        }
        
        .timetable-cell:hover {
            background-color: #f9f9f9;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
        }
        .navbar {
            background-color: #222;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .navbar-left {
            display: flex;
            align-items: center;
        }
        .navbar-left a {
            color: #4CAF50;
            text-decoration: none;
            margin-right: 15px;
        }
        .logo {
            color: #4CAF50;
            font-weight: bold;
            margin-right: 20px;
        }
        .navbar-right a {
            color: #4CAF50;
            text-decoration: none;
        }
        .container {
            width: 95%;
            margin: 20px auto;
        }
        h1 {
            color: #333;
            margin-bottom: 20px;
        }
        .info-card {
            background-color: white;
            border-radius: 5px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .info-row {
            display: flex;
            margin-bottom: 15px;
        }
        .info-col {
            flex: 1;
        }
        .info-label {
            font-weight: bold;
            margin-right: 5px;
        }
        .action-buttons {
            margin-bottom: 20px;
        }
        .btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 8px 15px;
            margin-right: 10px;
            border-radius: 4px;
            cursor: pointer;
        }
        .btn:hover {
            background-color: #45a049;
        }
        .btn-secondary {
            background-color: #555;
        }
        .btn-secondary:hover {
            background-color: #666;
        }

        .timetable-cell {
            cursor: pointer;
        }
        
        .timetable-cell:hover {
            background-color: #f9f9f9;
        }

        .timetable {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .timetable th, .timetable td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }
        .timetable th {
            background-color: #f2f2f2;
        }
        .timetable td {
            background-color: white;
        }
        .day-column {
            background-color: #00cc7a !important;
            color: white;
            font-weight: bold;
        }
        .free-slot {
            background-color: white;
        }
        .break-slot {
            background-color: #f2f2f2;
        }
        .class-slot {
            color: #333;
        }
       
    .editable {
        border: 1px solid #4CAF50;
        padding: 5px;
        border-radius: 4px;
        background-color: #f9f9f9;
    }

    </style>
</head>
<body>
    <div class="navbar">
        <div class="navbar-left">
            <div class="logo">Tathya</div>
        </div>
        <div class="navbar-right">
            <a href="/profile">Home</a>
            <a href="/find">Findfaculty</a>
            <a href="/login">Logout</a>
        </div>
    </div>
    
    <div class="container">
        <h1>Teacher Information</h1>
        <button class="btn btn-primary" id="downloadWordBtn" style="margin-bottom: 10px;margin-left: 90%;">Download as Word</button>
        
        
        <div class="info-card">
            <h2 id="teacherName">Loading...</h2>
        
            <div class="info-row">
                <div class="info-col">
                    <span class="info-label">Designation:</span>
                    <span id="designation">Loading...</span>
                </div>
                <div class="info-col">
                    <span class="info-label">Qualification:</span>
                    <span id="qualification">Loading...</span>
                </div>
            </div>
        
            <div class="info-row">
                <div class="info-col">
                    <span class="info-label">Department:</span>
                    <span id="department">Loading...</span>
                </div>
                <div class="info-col">
                    <span class="info-label">Date of Birth:</span>
                    <span id="dob">Loading...</span>
                </div>
            </div>
        
            <div class="info-row">
                <div class="info-col">
                    <span class="info-label">Email:</span>
                    <span id="email">Loading...</span>
                </div>
                <div class="info-col">
                    <span class="info-label">Gender:</span>
                    <span id="gender">Loading...</span>
                </div>
            </div>
            <div class="info-row">
                <div class="info-col">
                    <span class="info-label">Experience:</span>
                    <span id="experience">Loading...</span>
                </div>
                <div class="info-col">
                    <span class="info-label">Mobile:</span>
                    <span id="mobile">Loading...</span>
                </div>
            </div>
            
        </div>
        
        
        <h1>Timetable</h1>
        
        <div class="action-buttons">
            <button class="btn btn-secondary" id="editTimetableBtn">Edit Timetable</button>

        </div>
        
        <table class="timetable" id="timetableTable">
            <thead>
                <tr>
                    <th>Day</th>
                    <th>1</th>
                    <th>2</th>
                    <th>3</th>
                    <th>4</th>
                    <th>5</th>
                    <th>6</th>
                    <th>7</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="day-column">Monday</td>
                    <td class="timetable-cell" data-day="Monday" data-period="1">ADSJ</td>
                    <td class="timetable-cell" data-day="Monday" data-period="2">ADSJ</td>
                    <td class="timetable-cell" data-day="Monday" data-period="3">FREE</td>
                    <td class="timetable-cell" data-day="Monday" data-period="4">ADSJ</td>
                    <td class="timetable-cell" data-day="Monday" data-period="5">BREAK</td>
                    <td class="timetable-cell" data-day="Monday" data-period="6">FREE</td>
                    <td class="timetable-cell" data-day="Monday" data-period="7">FREE</td>
                </tr>
                <tr>
                    <td class="day-column">Tuesday</td>
                    <td class="timetable-cell" data-day="Tuesday" data-period="1">ADSJL</td>
                    <td class="timetable-cell" data-day="Tuesday" data-period="2">ADSJL</td>
                    <td class="timetable-cell" data-day="Tuesday" data-period="3">ADSJL</td>
                    <td class="timetable-cell" data-day="Tuesday" data-period="4">FREE</td>
                    <td class="timetable-cell" data-day="Tuesday" data-period="5">BREAK</td>
                    <td class="timetable-cell" data-day="Tuesday" data-period="6">FREE</td>
                    <td class="timetable-cell" data-day="Tuesday" data-period="7">ADSJ</td>
                </tr>
                <tr>
                    <td class="day-column">Wednesday</td>
                    <td class="timetable-cell" data-day="Wednesday" data-period="1">FREE</td>
                    <td class="timetable-cell" data-day="Wednesday" data-period="2">ADSJL</td>
                    <td class="timetable-cell" data-day="Wednesday" data-period="3">ADSJL</td>
                    <td class="timetable-cell" data-day="Wednesday" data-period="4">ADSJL</td>
                    <td class="timetable-cell" data-day="Wednesday" data-period="5">BREAK</td>
                    <td class="timetable-cell" data-day="Wednesday" data-period="6">ADSJ</td>
                    <td class="timetable-cell" data-day="Wednesday" data-period="7">FREE</td>
                </tr>
                <tr>
                    <td class="day-column">Thursday</td>
                    <td class="timetable-cell" data-day="Thursday" data-period="1">FREE</td>
                    <td class="timetable-cell" data-day="Thursday" data-period="2">FREE</td>
                    <td class="timetable-cell" data-day="Thursday" data-period="3">ADSJ</td>
                    <td class="timetable-cell" data-day="Thursday" data-period="4">FREE</td>
                    <td class="timetable-cell" data-day="Thursday" data-period="5">BREAK</td>
                    <td class="timetable-cell" data-day="Thursday" data-period="6">ADSJ</td>
                    <td class="timetable-cell" data-day="Thursday" data-period="7">ADSJ</td>
                </tr>
                <tr>
                    <td class="day-column">Friday</td>
                    <td class="timetable-cell" data-day="Friday" data-period="1">FREE</td>
                    <td class="timetable-cell" data-day="Friday" data-period="2">ADSJL</td>
                    <td class="timetable-cell" data-day="Friday" data-period="3">ADSJL</td>
                    <td class="timetable-cell" data-day="Friday" data-period="4">ADSJL</td>
                    <td class="timetable-cell" data-day="Friday" data-period="5">BREAK</td>
                    <td class="timetable-cell" data-day="Friday" data-period="6">FREE</td>
                    <td class="timetable-cell" data-day="Friday" data-period="7">ADSJ</td>
                </tr>
                <tr>
                    <td class="day-column">Saturday</td>
                    <td class="timetable-cell" data-day="Saturday" data-period="1">ADSJ</td>
                    <td class="timetable-cell" data-day="Saturday" data-period="2">ADSJ</td>
                    <td class="timetable-cell" data-day="Saturday" data-period="3">FREE</td>
                    <td class="timetable-cell" data-day="Saturday" data-period="4">FREE</td>
                    <td class="timetable-cell" data-day="Saturday" data-period="5">BREAK</td>
                    <td class="timetable-cell" data-day="Saturday" data-period="6">FREE</td>
                    <td class="timetable-cell" data-day="Saturday" data-period="7">FREE</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Timetable Cell Edit Modal -->
    <div id="timetableModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeTimetableModal()">&times;</span>
            <h2>Edit Timetable Entry</h2>
            <div class="form-group">
                <label for="editDay">Day:</label>
                <input type="text" id="editDay" readonly>
            </div>
            <div class="form-group">
                <label for="editPeriod">Period:</label>
                <input type="text" id="editPeriod" readonly>
            </div>
            <div class="form-group">
                <label for="editClass">Class/Status:</label>
                <select id="editClass">
                    <option value="FREE">FREE</option>
                    <option value="BREAK">BREAK</option>
                    <option value="ADSJ">ADSJ</option>
                    <option value="ADSJL">ADSJL</option>
                </select>
            </div>
            <button class="btn" onclick="saveTimetableCell()">Save Changes</button>
        </div>
    </div>
    

    </div>
    
    <script>

document.getElementById("downloadWordBtn").addEventListener("click", function () {
        const facultyName = document.getElementById('teacherName').textContent;
        const designation = document.getElementById('designation').textContent;
        const qualification = document.getElementById('qualification').textContent;
        const department = document.getElementById('department').textContent;
        const email = document.getElementById('email').textContent;
        const dob = document.getElementById('dob').textContent;
        const gender = document.getElementById('gender').textContent;
        const experience = document.getElementById('experience').textContent;
        const mobile = document.getElementById('mobile').textContent;


        // Create the document content
        const content = `
            <html xmlns:o="urn:schemas-microsoft-com:office:office"
                xmlns:w="urn:schemas-microsoft-com:office:word"
                xmlns="http://www.w3.org/TR/REC-html40">
                <head><meta charset='utf-8'></head>
                <body>
                    <h2>Faculty Details</h2>
                    <p><strong>Name:</strong> ${facultyName}</p>
                    <p><strong>Designation:</strong> ${designation}</p>
                    <p><strong>Qualification:</strong> ${qualification}</p>
                    <p><strong>Department:</strong> ${department}</p>
                    <p><strong>Email:</strong> ${email}</p>
                    <p><strong>Date of Birth:</strong> ${dob}</p>
                    <p><strong>Gender:</strong> ${gender}</p>
                    <p><strong>Experience:</strong> ${experience}</p>
                    <p><strong>Mobile:</strong> ${mobile}</p>
                </body>
            </html>`;

        // Create Blob and Download
        const blob = new Blob(['\ufeff', content], { type: 'application/msword' });
        const url = URL.createObjectURL(blob);

        const link = document.createElement('a');
        link.href = url;
        link.download = `${facultyName}_Details.doc`;

        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    });


    // Function to fetch faculty details from the backend
    async function fetchFacultyDetails() {
        const params = new URLSearchParams(window.location.search);
        const facultyId = params.get('id'); // Get faculty ID from URL

        if (!facultyId) {
            alert("Faculty ID is missing in the URL.");
            return;
        }

        try {
            const response = await fetch(`http://127.0.0.1:3000/getProfile/${facultyId}`);
            const data = await response.json();

            if (!data || !data.name) {
                alert("Faculty details not found.");
                return;
            }

            // Populate fields with backend data
            document.getElementById('teacherName').textContent = data.name || 'N/A';
            document.getElementById('designation').textContent = data.designation || 'N/A';
            document.getElementById('qualification').textContent = data.qualification || 'N/A';
            document.getElementById('department').textContent = data.department || 'N/A';
            document.getElementById('email').textContent = data.email || 'N/A';
            document.getElementById('dob').textContent = formatDateToDDMMMYYYY(data.dob) || 'N/A';
            document.getElementById('gender').textContent = data.gender || 'N/A';
            document.getElementById('experience').textContent = data.experience || 'N/A';
            document.getElementById('mobile').textContent = data.mobile || 'N/A';

        } catch (error) {
            console.error("Error fetching faculty details:", error);
            alert("Failed to load faculty details.");
        }
    }

    // Function to format the date as DD-MMM-YYYY
    function formatDateToDDMMMYYYY(dateString) {
        if (!dateString) return 'N/A';
        const date = new Date(dateString);
        return new Intl.DateTimeFormat('en-GB', { day: '2-digit', month: 'short', year: 'numeric' }).format(date);
    }

    // Call the function to fetch data when the page loads
    document.addEventListener('DOMContentLoaded', fetchFacultyDetails);
</script>


</body>
</html>